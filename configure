#! /bin/sh

src_path=`echo $0 | sed -e s:/configure$::`
bld_path=`pwd`

#FIXME: need to check whether src and bld are the same

mkfile=${bld_path}/Makefile

if test -d $mkfile ; then
  rm -rf $mkfile
fi

sed -e "s:HPCG_ROOT_PATH:${bld_path}:g" ${src_path}/Makefile.ext | sed -e "s:HPCG_SRC_PATH:${src_path}:g" > $mkfile

# creating missing directories
for path in src testing bin
do
  if test ! -d $path ; then
    mkdir $path
  fi
done

# copy hpcg.dat if it doesn't exist
if test ! -f bin/hpcg.dat ; then
  cp ${src_path}/bin/hpcg.dat bin/hpcg.dat
fi
